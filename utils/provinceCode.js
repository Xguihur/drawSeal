/**
 * 省份/城市 → 行政区划代码前两位 对照表
 * 用于根据省份或城市名称匹配对应的编码开头，后续生成随机编号时使用
 * 城市与省份共用同一个编码前缀，方便从公司名中提取地域信息
 */
const provinceCodeMap = {
  // ===== 省份简称 =====
  '北京': '11',
  '天津': '12',
  '河北': '13',
  '山西': '14',
  '内蒙古': '15',
  '辽宁': '21',
  '吉林': '22',
  '黑龙江': '23',
  '上海': '31',
  '江苏': '32',
  '浙江': '33',
  '安徽': '34',
  '福建': '35',
  '江西': '36',
  '山东': '37',
  '河南': '41',
  '湖北': '42',
  '湖南': '43',
  '广东': '44',
  '广西': '45',
  '海南': '46',
  '重庆': '50',
  '四川': '51',
  '贵州': '52',
  '云南': '53',
  '西藏': '54',
  '陕西': '61',
  '甘肃': '62',
  '青海': '63',
  '宁夏': '64',
  '新疆': '65',
  '香港': '81',
  '澳门': '82',

  // ===== 省份全称 =====
  '北京市': '11',
  '天津市': '12',
  '河北省': '13',
  '山西省': '14',
  '内蒙古自治区': '15',
  '辽宁省': '21',
  '吉林省': '22',
  '黑龙江省': '23',
  '上海市': '31',
  '江苏省': '32',
  '浙江省': '33',
  '安徽省': '34',
  '福建省': '35',
  '江西省': '36',
  '山东省': '37',
  '河南省': '41',
  '湖北省': '42',
  '湖南省': '43',
  '广东省': '44',
  '广西壮族自治区': '45',
  '海南省': '46',
  '重庆市': '50',
  '四川省': '51',
  '贵州省': '52',
  '云南省': '53',
  '西藏自治区': '54',
  '陕西省': '61',
  '甘肃省': '62',
  '青海省': '63',
  '宁夏回族自治区': '64',
  '新疆维吾尔自治区': '65',

  // ===== 广东省 (44) 下辖城市 =====
  '广州': '44',
  '广州市': '44',
  '深圳': '44',
  '深圳市': '44',
  '珠海': '44',
  '珠海市': '44',
  '汕头': '44',
  '汕头市': '44',
  '佛山': '44',
  '佛山市': '44',
  '江门': '44',
  '江门市': '44',
  '湛江': '44',
  '湛江市': '44',
  '茂名': '44',
  '茂名市': '44',
  '肇庆': '44',
  '肇庆市': '44',
  '惠州': '44',
  '惠州市': '44',
  '梅州': '44',
  '梅州市': '44',
  '汕尾': '44',
  '汕尾市': '44',
  '河源': '44',
  '河源市': '44',
  '阳江': '44',
  '阳江市': '44',
  '清远': '44',
  '清远市': '44',
  '东莞': '44',
  '东莞市': '44',
  '中山': '44',
  '中山市': '44',
  '潮州': '44',
  '潮州市': '44',
  '揭阳': '44',
  '揭阳市': '44',
  '云浮': '44',
  '云浮市': '44',
  '韶关': '44',
  '韶关市': '44',

  // ===== 江苏省 (32) 下辖城市 =====
  '南京': '32',
  '南京市': '32',
  '无锡': '32',
  '无锡市': '32',
  '徐州': '32',
  '徐州市': '32',
  '常州': '32',
  '常州市': '32',
  '苏州': '32',
  '苏州市': '32',
  '南通': '32',
  '南通市': '32',
  '连云港': '32',
  '连云港市': '32',
  '淮安': '32',
  '淮安市': '32',
  '盐城': '32',
  '盐城市': '32',
  '扬州': '32',
  '扬州市': '32',
  '镇江': '32',
  '镇江市': '32',
  '泰州': '32',
  '泰州市': '32',
  '宿迁': '32',
  '宿迁市': '32',

  // ===== 浙江省 (33) 下辖城市 =====
  '杭州': '33',
  '杭州市': '33',
  '宁波': '33',
  '宁波市': '33',
  '温州': '33',
  '温州市': '33',
  '嘉兴': '33',
  '嘉兴市': '33',
  '湖州': '33',
  '湖州市': '33',
  '绍兴': '33',
  '绍兴市': '33',
  '金华': '33',
  '金华市': '33',
  '衢州': '33',
  '衢州市': '33',
  '舟山': '33',
  '舟山市': '33',
  '台州': '33',
  '台州市': '33',
  '丽水': '33',
  '丽水市': '33',

  // ===== 福建省 (35) 下辖城市 =====
  '福州': '35',
  '福州市': '35',
  '厦门': '35',
  '厦门市': '35',
  '莆田': '35',
  '莆田市': '35',
  '三明': '35',
  '三明市': '35',
  '泉州': '35',
  '泉州市': '35',
  '漳州': '35',
  '漳州市': '35',
  '南平': '35',
  '南平市': '35',
  '龙岩': '35',
  '龙岩市': '35',
  '宁德': '35',
  '宁德市': '35',

  // ===== 四川省 (51) 下辖城市 =====
  '成都': '51',
  '成都市': '51',
  '自贡': '51',
  '自贡市': '51',
  '攀枝花': '51',
  '攀枝花市': '51',
  '泸州': '51',
  '泸州市': '51',
  '德阳': '51',
  '德阳市': '51',
  '绵阳': '51',
  '绵阳市': '51',
  '广元': '51',
  '广元市': '51',
  '遂宁': '51',
  '遂宁市': '51',
  '内江': '51',
  '内江市': '51',
  '乐山': '51',
  '乐山市': '51',
  '南充': '51',
  '南充市': '51',
  '眉山': '51',
  '眉山市': '51',
  '宜宾': '51',
  '宜宾市': '51',
  '广安': '51',
  '广安市': '51',
  '达州': '51',
  '达州市': '51',
  '雅安': '51',
  '雅安市': '51',
  '巴中': '51',
  '巴中市': '51',
  '资阳': '51',
  '资阳市': '51',
  '阿坝藏族羌族自治州': '51',
  '甘孜藏族自治州': '51',
  '凉山彝族自治州': '51',

  // ===== 湖北省 (42) 下辖城市 =====
  '武汉': '42',
  '武汉市': '42',
  '黄石': '42',
  '黄石市': '42',
  '十堰': '42',
  '十堰市': '42',
  '宜昌': '42',
  '宜昌市': '42',
  '襄阳': '42',
  '襄阳市': '42',
  '鄂州': '42',
  '鄂州市': '42',
  '荆门': '42',
  '荆门市': '42',
  '孝感': '42',
  '孝感市': '42',
  '荆州': '42',
  '荆州市': '42',
  '黄冈': '42',
  '黄冈市': '42',
  '咸宁': '42',
  '咸宁市': '42',
  '随州': '42',
  '随州市': '42',
  '恩施土家族苗族自治州': '42',
  '仙桃': '42',
  '仙桃市': '42',
  '潜江': '42',
  '潜江市': '42',
  '天门': '42',
  '天门市': '42',
  '神农架': '42',

  // ===== 湖南省 (43) 下辖城市 =====
  '长沙': '43',
  '长沙市': '43',
  '株洲': '43',
  '株洲市': '43',
  '湘潭': '43',
  '湘潭市': '43',
  '衡阳': '43',
  '衡阳市': '43',
  '邵阳': '43',
  '邵阳市': '43',
  '岳阳': '43',
  '岳阳市': '43',
  '常德': '43',
  '常德市': '43',
  '张家界': '43',
  '张家界市': '43',
  '益阳': '43',
  '益阳市': '43',
  '郴州': '43',
  '郴州市': '43',
  '永州': '43',
  '永州市': '43',
  '怀化': '43',
  '怀化市': '43',
  '娄底': '43',
  '娄底市': '43',
  '湘西土家族苗族自治州': '43',

  // ===== 陕西省 (61) 下辖城市 =====
  '西安': '61',
  '西安市': '61',
  '铜川': '61',
  '铜川市': '61',
  '宝鸡': '61',
  '宝鸡市': '61',
  '咸阳': '61',
  '咸阳市': '61',
  '渭南': '61',
  '渭南市': '61',
  '延安': '61',
  '延安市': '61',
  '汉中': '61',
  '汉中市': '61',
  '榆林': '61',
  '榆林市': '61',
  '安康': '61',
  '安康市': '61',
  '商洛': '61',
  '商洛市': '61',

  // ===== 云南省 (53) 下辖城市 =====
  '昆明': '53',
  '昆明市': '53',
  '曲靖': '53',
  '曲靖市': '53',
  '玉溪': '53',
  '玉溪市': '53',
  '保山': '53',
  '保山市': '53',
  '昭通': '53',
  '昭通市': '53',
  '丽江': '53',
  '丽江市': '53',
  '普洱': '53',
  '普洱市': '53',
  '临沧': '53',
  '临沧市': '53',
  '楚雄彝族自治州': '53',
  '红河哈尼族彝族自治州': '53',
  '文山壮族苗族自治州': '53',
  '西双版纳傣族自治州': '53',
  '大理白族自治州': '53',
  '德宏傣族景颇族自治州': '53',
  '怒江傈僳族自治州': '53',
  '迪庆藏族自治州': '53',

  // ===== 安徽省 (34) 下辖城市 =====
  '合肥': '34',
  '合肥市': '34',
  '芜湖': '34',
  '芜湖市': '34',
  '蚌埠': '34',
  '蚌埠市': '34',
  '淮南': '34',
  '淮南市': '34',
  '马鞍山': '34',
  '马鞍山市': '34',
  '淮北': '34',
  '淮北市': '34',
  '铜陵': '34',
  '铜陵市': '34',
  '安庆': '34',
  '安庆市': '34',
  '黄山': '34',
  '黄山市': '34',
  '滁州': '34',
  '滁州市': '34',
  '阜阳': '34',
  '阜阳市': '34',
  '宿州': '34',
  '宿州市': '34',
  '巢湖': '34',
  '巢湖市': '34',
  '六安': '34',
  '六安市': '34',
  '亳州': '34',
  '亳州市': '34',
  '池州': '34',
  '池州市': '34',
  '宣城': '34',
  '宣城市': '34',

  // ===== 广西壮族自治区 (45) 下辖城市 =====
  '南宁': '45',
  '南宁市': '45',
  '柳州': '45',
  '柳州市': '45',
  '桂林': '45',
  '桂林市': '45',
  '梧州': '45',
  '梧州市': '45',
  '北海': '45',
  '北海市': '45',
  '防城港': '45',
  '防城港市': '45',
  '钦州': '45',
  '钦州市': '45',
  '贵港': '45',
  '贵港市': '45',
  '玉林': '45',
  '玉林市': '45',
  '百色': '45',
  '百色市': '45',
  '贺州': '45',
  '贺州市': '45',
  '河池': '45',
  '河池市': '45',
  '来宾': '45',
  '来宾市': '45',
  '崇左': '45',
  '崇左市': '45',

  // ===== 新疆维吾尔自治区 (65) 下辖城市 =====
  '乌鲁木齐': '65',
  '乌鲁木齐市': '65',
  '克拉玛依': '65',
  '克拉玛依市': '65',
  '吐鲁番': '65',
  '吐鲁番地区': '65',
  '哈密': '65',
  '哈密地区': '65',
  '昌吉回族自治州': '65',
  '博尔塔拉蒙古自治州': '65',
  '巴音郭楞蒙古自治州': '65',
  '阿克苏': '65',
  '阿克苏地区': '65',
  '克孜勒苏柯尔克孜自治州': '65',
  '喀什': '65',
  '喀什地区': '65',
  '和田': '65',
  '和田地区': '65',
  '伊犁哈萨克自治州': '65',
  '塔城': '65',
  '塔城地区': '65',
  '阿勒泰': '65',
  '阿勒泰地区': '65',
  '石河子': '65',
  '石河子市': '65',
  '奎屯': '65',
  '奎屯市': '65',

  // ===== 江西省 (36) 下辖城市 =====
  '南昌': '36',
  '南昌市': '36',
  '景德镇': '36',
  '景德镇市': '36',
  '萍乡': '36',
  '萍乡市': '36',
  '九江': '36',
  '九江市': '36',
  '新余': '36',
  '新余市': '36',
  '鹰潭': '36',
  '鹰潭市': '36',
  '赣州': '36',
  '赣州市': '36',
  '吉安': '36',
  '吉安市': '36',
  '宜春': '36',
  '宜春市': '36',
  '抚州': '36',
  '抚州市': '36',
  '上饶': '36',
  '上饶市': '36',

  // ===== 甘肃省 (62) 下辖城市 =====
  '兰州': '62',
  '兰州市': '62',
  '嘉峪关': '62',
  '嘉峪关市': '62',
  '金昌': '62',
  '金昌市': '62',
  '白银': '62',
  '白银市': '62',
  '天水': '62',
  '天水市': '62',
  '武威': '62',
  '武威市': '62',
  '张掖': '62',
  '张掖市': '62',
  '平凉': '62',
  '平凉市': '62',
  '酒泉': '62',
  '酒泉市': '62',
  '庆阳': '62',
  '庆阳市': '62',
  '定西': '62',
  '定西市': '62',
  '陇南': '62',
  '陇南市': '62',
  '临夏回族自治州': '62',
  '甘南藏族自治州': '62',

  // ===== 贵州省 (52) 下辖城市 =====
  '贵阳': '52',
  '贵阳市': '52',
  '六盘水': '52',
  '六盘水市': '52',
  '遵义': '52',
  '遵义市': '52',
  '安顺': '52',
  '安顺市': '52',
  '铜仁': '52',
  '铜仁地区': '52',
  '黔西南布依族苗族自治州': '52',
  '毕节': '52',
  '毕节地区': '52',
  '黔东南苗族侗族自治州': '52',
  '黔南布依族苗族自治州': '52',

  // ===== 海南省 (46) 下辖城市 =====
  '海口': '46',
  '海口市': '46',

  // ===== 宁夏回族自治区 (64) 下辖城市 =====
  '银川': '64',
  '银川市': '64',
  '石嘴山': '64',
  '石嘴山市': '64',
  '吴忠': '64',
  '吴忠市': '64',
  '固原': '64',
  '固原市': '64',
  '中卫': '64',
  '中卫市': '64',

  // ===== 青海省 (63) 下辖城市 =====
  '西宁': '63',
  '西宁市': '63',
  '海东': '63',
  '海东地区': '63',
  '海北藏族自治州': '63',
  '黄南藏族自治州': '63',
  '海南藏族自治州': '63',
  '果洛藏族自治州': '63',
  '玉树藏族自治州': '63',
  '海西蒙古族藏族自治州': '63',
  '格尔木': '63',
  '格尔木市': '63',

  // ===== 西藏自治区 (54) 下辖城市 =====
  '拉萨': '54',
  '拉萨市': '54',
  '昌都': '54',
  '昌都地区': '54',
  '山南': '54',
  '山南地区': '54',
  '日喀则': '54',
  '日喀则地区': '54',
  '那曲': '54',
  '那曲地区': '54',
  '阿里': '54',
  '阿里地区': '54',
  '林芝': '54',
  '林芝地区': '54',

  // ===== 山东省 (37) 下辖城市 =====
  '济南': '37',
  '济南市': '37',
  '青岛': '37',
  '青岛市': '37',
  '淄博': '37',
  '淄博市': '37',
  '枣庄': '37',
  '枣庄市': '37',
  '东营': '37',
  '东营市': '37',
  '烟台': '37',
  '烟台市': '37',
  '潍坊': '37',
  '潍坊市': '37',
  '济宁': '37',
  '济宁市': '37',
  '泰安': '37',
  '泰安市': '37',
  '威海': '37',
  '威海市': '37',
  '日照': '37',
  '日照市': '37',
  '莱芜': '37',
  '莱芜市': '37',
  '临沂': '37',
  '临沂市': '37',
  '德州': '37',
  '德州市': '37',
  '聊城': '37',
  '聊城市': '37',
  '滨州': '37',
  '滨州市': '37',
  '菏泽': '37',
  '菏泽市': '37',

  // ===== 河南省 (41) 下辖城市 =====
  '郑州': '41',
  '郑州市': '41',
  '开封': '41',
  '开封市': '41',
  '洛阳': '41',
  '洛阳市': '41',
  '平顶山': '41',
  '平顶山市': '41',
  '安阳': '41',
  '安阳市': '41',
  '鹤壁': '41',
  '鹤壁市': '41',
  '新乡': '41',
  '新乡市': '41',
  '焦作': '41',
  '焦作市': '41',
  '濮阳': '41',
  '濮阳市': '41',
  '许昌': '41',
  '许昌市': '41',
  '漯河': '41',
  '漯河市': '41',
  '三门峡': '41',
  '三门峡市': '41',
  '南阳': '41',
  '南阳市': '41',
  '商丘': '41',
  '商丘市': '41',
  '信阳': '41',
  '信阳市': '41',
  '周口': '41',
  '周口市': '41',
  '驻马店': '41',
  '驻马店市': '41',
  '济源': '41',
  '济源市': '41',

  // ===== 辽宁省 (21) 下辖城市 =====
  '沈阳': '21',
  '沈阳市': '21',
  '大连': '21',
  '大连市': '21',
  '鞍山': '21',
  '鞍山市': '21',
  '抚顺': '21',
  '抚顺市': '21',
  '本溪': '21',
  '本溪市': '21',
  '丹东': '21',
  '丹东市': '21',
  '锦州': '21',
  '锦州市': '21',
  '营口': '21',
  '营口市': '21',
  '阜新': '21',
  '阜新市': '21',
  '辽阳': '21',
  '辽阳市': '21',
  '盘锦': '21',
  '盘锦市': '21',
  '铁岭': '21',
  '铁岭市': '21',
  '朝阳': '21',
  '朝阳市': '21',
  '葫芦岛': '21',
  '葫芦岛市': '21',

  // ===== 河北省 (13) 下辖城市 =====
  '石家庄': '13',
  '石家庄市': '13',
  '唐山': '13',
  '唐山市': '13',
  '秦皇岛': '13',
  '秦皇岛市': '13',
  '邯郸': '13',
  '邯郸市': '13',
  '邢台': '13',
  '邢台市': '13',
  '保定': '13',
  '保定市': '13',
  '张家口': '13',
  '张家口市': '13',
  '承德': '13',
  '承德市': '13',
  '沧州': '13',
  '沧州市': '13',
  '廊坊': '13',
  '廊坊市': '13',
  '衡水': '13',
  '衡水市': '13',

  // ===== 山西省 (14) 下辖城市 =====
  '太原': '14',
  '太原市': '14',
  '大同': '14',
  '大同市': '14',
  '阳泉': '14',
  '阳泉市': '14',
  '长治': '14',
  '长治市': '14',
  '晋城': '14',
  '晋城市': '14',
  '朔州': '14',
  '朔州市': '14',
  '晋中': '14',
  '晋中市': '14',
  '运城': '14',
  '运城市': '14',
  '忻州': '14',
  '忻州市': '14',
  '临汾': '14',
  '临汾市': '14',
  '吕梁': '14',
  '吕梁市': '14',

  // ===== 内蒙古自治区 (15) 下辖城市 =====
  '呼和浩特': '15',
  '呼和浩特市': '15',
  '包头': '15',
  '包头市': '15',
  '乌海': '15',
  '乌海市': '15',
  '赤峰': '15',
  '赤峰市': '15',
  '通辽': '15',
  '通辽市': '15',
  '鄂尔多斯': '15',
  '鄂尔多斯市': '15',
  '呼伦贝尔': '15',
  '呼伦贝尔市': '15',
  '巴彦淖尔': '15',
  '巴彦淖尔市': '15',
  '乌兰察布': '15',
  '乌兰察布市': '15',
  '兴安盟': '15',
  '锡林郭勒盟': '15',
  '阿拉善盟': '15',

  // ===== 吉林省 (22) 下辖城市 =====
  '长春': '22',
  '长春市': '22',
  '吉林市': '22',
  '四平': '22',
  '四平市': '22',
  '辽源': '22',
  '辽源市': '22',
  '通化': '22',
  '通化市': '22',
  '白山': '22',
  '白山市': '22',
  '松原': '22',
  '松原市': '22',
  '白城': '22',
  '白城市': '22',
  '延边朝鲜族自治州': '22',

  // ===== 黑龙江省 (23) 下辖城市 =====
  '哈尔滨': '23',
  '哈尔滨市': '23',
  '齐齐哈尔': '23',
  '齐齐哈尔市': '23',
  '鸡西': '23',
  '鸡西市': '23',
  '鹤岗': '23',
  '鹤岗市': '23',
  '双鸭山': '23',
  '双鸭山市': '23',
  '大庆': '23',
  '大庆市': '23',
  '伊春': '23',
  '伊春市': '23',
  '佳木斯': '23',
  '佳木斯市': '23',
  '七台河': '23',
  '七台河市': '23',
  '牡丹江': '23',
  '牡丹江市': '23',
  '黑河': '23',
  '黑河市': '23',
  '绥化': '23',
  '绥化市': '23',
  '安达': '23',
  '安达市': '23',
  '肇东': '23',
  '肇东市': '23',
  '大兴安岭': '23',
  '大兴安岭地区': '23',
};

/**
 * 根据省份/城市名称获取对应的编码前缀
 * @param {string} name - 省份或城市名称（如：北京、广东、深圳、深圳市等）
 * @returns {string|null} 对应的两位编码前缀，未匹配到返回 null
 */
function getProvinceCode(name) {
  // 先尝试精确匹配
  if (provinceCodeMap[name]) {
    return provinceCodeMap[name];
  }
  // 再尝试模糊匹配（如传入"深圳市某某有限公司"能匹配到"深圳市"或"深圳"）
  // 优先匹配较长的 key，避免短 key 误匹配
  const keys = Object.keys(provinceCodeMap).sort((a, b) => b.length - a.length);
  for (const key of keys) {
    if (name.includes(key)) {
      return provinceCodeMap[key];
    }
  }
  return null;
}

/**
 * 根据省份/城市名称生成随机编码
 * 格式：省份前缀(2位) + 随机数字(11位)，共13位
 * @param {string} name - 省份或城市名称
 * @returns {string} 13位随机编码
 */
function generateRandomCode(name) {
  const prefix = getProvinceCode(name);
  if (!prefix) {
    throw new Error(`未找到"${name}"对应的编码`);
  }
  // 生成11位随机数字
  const randomPart = Array.from({ length: 11 }, () => Math.floor(Math.random() * 10)).join('');
  return prefix + randomPart;
}

module.exports = {
  provinceCodeMap,
  getProvinceCode,
  generateRandomCode,
};
